import tkinter as tk
from tkinter import filedialog, messagebox
from backend import read_csv, validate_data
from ui import create_main_window, display_results

class VulnerabilityApp:
    def __init__(self, window):
        self.window = window
        self.df = None

        # Create the UI components
        self.create_ui()

    def create_ui(self):
        self.window.configure(bg='#f5f5f5')

        title_label = tk.Label(self.window, text="Vulnerability Reader", font=("Helvetica", 16), bg='#f5f5f5')
        title_label.pack(pady=20)

        upload_button = tk.Button(self.window, text="Upload CSV", command=self.upload_file, font=("Helvetica", 12), bg='#4CAF50', fg='white', padx=20, pady=10)
        upload_button.pack(pady=10)

    def upload_file(self):
        file_path = filedialog.askopenfilename(filetypes=[("CSV files", "*.csv")])
        if file_path:
            try:
                self.df = read_csv(file_path)
                validate_data(self.df)
                self.display_results()
            except Exception as e:
                messagebox.showerror("Error", str(e))

    def display_results(self):
        display_results(self.window, self.df)

if __name__ == "__main__":
    root = create_main_window()
    app = VulnerabilityApp(root)
    root.mainloop()
