import pandas as pd

class DataProcessor:
    @staticmethod
    def read_csv(file_path):
        # Skip the first two rows as they are likely headers/metadata
        df = pd.read_csv(file_path, skiprows=2)
        df.columns = df.columns.str.strip()  # Strip any leading/trailing whitespace from column names
        
        # Renaming columns to match expected format
        df.columns = [
            'Name', 'Severity', 'CVSS v3', 'Epss score', 'Age (days)', 
            'Published', 'First detected', 'Updated', 'Has Exploit', 
            'Has Known Threats', 'Has Associated Alerts', 'Related Software', 'Description'
        ]
        
        df.reset_index(drop=True, inplace=True)  # Reset index
        print("Columns after processing:", df.columns.tolist())  # Print the column names for debugging
        print("DataFrame head after processing:\n", df.head())  # Print the first few rows for debugging
        return df

    @staticmethod
    def validate_data(df):
        required_columns = [
            'Name', 'Severity', 'CVSS v3', 'Epss score', 'Age (days)', 
            'Published', 'First detected', 'Updated', 'Has Exploit', 
            'Has Known Threats', 'Has Associated Alerts', 'Related Software', 'Description'
        ]
        for column in required_columns:
            if column not in df.columns:
                raise ValueError(f"Missing required column: {column}")
        return True

# Function aliases for easier import
read_csv = DataProcessor.read_csv
validate_data = DataProcessor.validate_data
